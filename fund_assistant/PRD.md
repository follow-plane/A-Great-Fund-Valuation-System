# 产品需求文档 (PRD) - 基金估值系统 & 股票行情分析助手

## 1. 产品概述
本产品是一款集成“基金智能管理”与“股票实时行情分析”的综合性理财软件。对标东方财富等专业金融终端，旨在为个人投资者提供从基础资产管理到深度数据分析的一站式解决方案。系统严格执行“真实数据”原则，所有行情均来源于主流金融接口，确保决策依据的科学性。

## 2. 核心目标
-   **全资产覆盖**：打破单一基金管理，引入 A 股股票行情，实现基金与股票的统一视图。
-   **专业级体验**：提供分时走势、K 线技术分析、五档盘口等专业交易工具。
-   **数据高精度**：持仓成本严格遵循 4 位小数精度，份额遵循 2 位小数精度，拒绝四舍五入误差。
-   **智能辅助决策**：集成 AI 深度诊断（基于deepseek大模型）与量化评分模型。
-   **极致数据隐私**：所有持仓数据本地 SQLite 存储，不进行任何云端上传。

## 3. 功能模块详情

### 3.1 股票行情与全球指数模块 (新增/核心)
-   **多维搜索**: 支持股票代码、名称、拼音缩写的模糊搜索。
-   **全球指数监控**: 
    -   集成标普 500、纳斯达克、道琼斯等美股核心指数。
    -   支持将任意 A 股个股或指数“钉”到仪表盘（自选行情）。
    -   **点击跳转**: 仪表盘中的自选行情支持点击直接跳转至分析页。
-   **实时行情**: 展示现价、涨跌幅、成交量、成交额、振幅、换手率等核心指标。
-   **专业图表**: 
    -   **分时图**: 包含昨收参考线及面积填充走势。
    -   **K 线图**: 支持日、周、月切换，集成 MA5/MA10/MA20 移动平均线。
-   **五档盘口**: 实时展示卖 1-5 及买 1-5 的价格与委托量。
-   **自动刷新**: 交易时段支持 3 秒级局部自动刷新（Fragment 技术）。

### 3.2 基金数据查询与深度诊断
-   **实时估值**: 对接东方财富接口，实时同步基金净值估算。
-   **搜索历史**: 自动保存最近 10 条搜索关键词，支持点击快速回填并搜索，支持手动清空历史。
-   **智能诊断**: 
    -   **本地模型**: 基于业绩、风险、经理、费率四维度的量化评分。
    -   **AI 分析**: 接入 DeepSeek，生成包含宏观环境、个基表现、操作建议的深度报告。
-   **数据刷新**: 手动刷新与 1 秒级自动刷新。

### 3.3 持仓管理与高精度收益统计
-   **界面汉化**: 所有数据表格表头均采用中文命名，提升易用性。
-   **精细化录入**: 
    -   **持仓成本**: 严格支持 4 位小数输入与存储。
    -   **持有份额**: 支持 2 位小数。
-   **资产透视**: 
    -   **全量曲线**: 仪表盘资产走势图自动追踪自“最早建仓日”起的资产变动，非固定的 30 天窗口。
-   **实时收益看板**: 
    -   **当日预估收益**: 基于实时估值动态计算。
    -   **累计盈亏**: 资产总额与总成本的实时差值。
-   **资产分布**: 通过饼图展示持仓结构。

### 3.4 智能定投规划
-   **灵活周期设定**: 
    -   **按周定投**: 支持指定每周几（如“每周四”）进行定投。
    -   **按月定投**: 支持指定每月几号（如“每月 15 日”）进行定投。
-   **真实回测**: 
    -   算法自动匹配定投日当天的真实净值（遇非交易日自动顺延至下一交易日）。
    -   提供定投删除功能，灵活管理计划。
-   **定投测算器**: 基于历史回测数据，输出乐观/中性/悲观三种预期收益曲线。

### 3.5 实时财经资讯
-   **资讯流**: 实时抓取**东方财富全球 7x24** 快讯。
-   **直达原文**: 资讯标题集成超链接，点击即可跳转至东方财富详情页。

### 3.6 配置持久化
-   **数据库存储**: 用户设置的 AI API Key、Base URL 及 AI 模型选择均自动保存至 SQLite 数据库 (`settings` 表)。
-   **自动加载**: 系统重启后自动恢复用户配置，无需重复输入。

## 4. 关键技术指标
-   **数据精度**: 成本 0.0001 步进，份额 0.01 步进。
-   **响应速度**: 侧边栏搜索毫秒级响应，主图表加载 < 1s。
-   **刷新频率**: 交易时段 Fragment 自动刷新（1s - 3s 可调）。

## 5. 数据要求与隐私
-   **数据源**: Sina HQ、EastMoney Push2、财联社、天天基金。
-   **存储**: `fund_data.db` (SQLite)。

## 6. 产品边界
-   **非交易终端**: 系统不提供下单、买卖等直接交易功能。
-   **免责声明**: AI 诊断及量化评分仅供参考，不构成任何形式的投资建议。
